#include <stdio.h>
#include <stdlib.h>// Для роботи з функціями вводу/виводу та генерації випадкових чисел
#include <time.h>// Для генерації випадкових чисел

#define MAX_SIZE 100// Максимальний розмір масиву

// Функція для очищення буфера
void clearInputBuffer() { // Очищення буфера вводу
    while (getchar() != '\n');// Читання символів до кінця рядка
}

int main() {
    int arr[MAX_SIZE];// Оголошення масиву
    int n, i, choice;// Розмір масиву, лічильник циклу, вибір користувача
    int minIndex, maxIndex;// Індекси мінімального та максимального елементів
    int sumNegative;// Сума від’ємних елементів
    long long productBetween;// Добуток елементів між мінімальним і максимальним

    while (1) {// Основний цикл програми
        printf("\n=== МЕНЮ ===\n");
        printf("0 - Вихід\n");
        printf("1 - Ввести масив вручну\n");
        printf("2 - Заповнити випадковими числами [-100; 100]\n");
        printf("Ваш вибір: ");

        if (scanf("%d", &choice) != 1) {//  Перевірка введення користувача
            printf(" Ви ввели не число!\n Спробуйте ще раз і введіть 0, 1 або 2.\n");
            clearInputBuffer();// Очищення буфера вводу
            continue;// Продовження циклу, якщо введення некоректне
        }

        if (choice == 0) {// Перевірка на вихід з програми
            printf(" Програму завершено користувачем.\n");// Повідомлення про завершення програми
            break;// Вихід з циклу
        }

        if (choice != 1 && choice != 2) {// Перевірка на допустимий вибір
            printf(" Недопустимий вибір. Введіть 1 або 2.\n");//      Повідомлення про помилку
            clearInputBuffer();// Очищення буфера вводу
            continue;// Продовження циклу, якщо вибір некоректний
        }

        printf("Введіть розмір масиву (1-100): ");// Запит розміру масиву
        if (scanf("%d", &n) != 1 || n <= 0 || n > MAX_SIZE) {// Перевірка на коректність розміру масиву
            printf(" Некоректний розмір масиву.\n Спробуйте ще раз.\n");
            clearInputBuffer();// Очищення буфера вводу
            continue;// Продовження циклу, якщо розмір некоректний
        }

        if (choice == 1) {// Введення масиву вручну
            for (i = 0; i < n; i++) {// Цикл для введення елементів масиву
                printf("arr[%d] = ", i);// Запит на введення елемента масиву
                if (scanf("%d", &arr[i]) != 1) {// Перевірка на коректність введення
                    printf(" Некоректне значення!\n Спробуйте знову з меню.\n");
                    clearInputBuffer();// Очищення буфера вводу
                    break;// Вихід з циклу, якщо введення некоректне
                }
            }
            if (i < n) continue;// Якщо введення перервано, повертаємося до початку циклу
        } else {// Заповнення масиву випадковими числами
            srand(time(NULL));// Ініціалізація генератора випадкових чисел
            printf("Згенерований масив:\n");// Повідомлення про генерацію масиву
            for (i = 0; i < n; i++) {// Цикл для заповнення масиву
                arr[i] = rand() % 201 - 100;// Генерація випадкового числа в діапазоні [-100; 100]
                printf("arr[%d] = %d\n", i, arr[i]);// Виведення згенерованого елемента масиву
            }
        }

        // Обчислення
        sumNegative = 0;// Ініціалізація суми від’ємних елементів
        productBetween = 1;// Ініціалізація добутку елементів між мінімальним і максимальним
        minIndex = 0;// Ініціалізація індексу мінімального елемента
        maxIndex = 0;// Ініціалізація індексу максимального елемента

        for (i = 0; i < n; i++) {// Цикл для обчислення суми від’ємних елементів та знаходження мінімального і максимального елементів
            if (arr[i] < 0) sumNegative += arr[i];// Додавання від’ємного елемента до суми
            if (arr[i] < arr[minIndex]) minIndex = i;// Знаходження індексу мінімального елемента
            if (arr[i] > arr[maxIndex]) maxIndex = i;// Знаходження індексу максимального елемента
        }

        if (minIndex > maxIndex) {// Перевірка порядку індексів мінімального і максимального елементів
            int temp = minIndex;// Збереження індексу мінімального елемента в тимчасову змінну
            minIndex = maxIndex;// Заміна індексу мінімального елемента на індекс максимального
            maxIndex = temp;// Заміна індексу максимального елемента на тимчасову змінну
        }

        if (maxIndex - minIndex <= 1) {// Перевірка на наявність елементів між мінімальним і максимальним
            printf("\n⚠ Немає елементів між мінімальним і максимальним.\n");// Повідомлення про відсутність елементів між мінімальним і максимальним
            productBetween = 0;// Встановлення добутку між мінімальним і максимальним елементами в 0
        } else {// Якщо є елементи між мінімальним і максимальним
            for (i = minIndex + 1; i < maxIndex; i++) {// Цикл для обчислення добутку елементів між мінімальним і максимальним
                productBetween *= arr[i];// Множення елемента на добуток
            }
        }

        printf("\nСума від’ємних елементів: %d\n", sumNegative);// Виведення суми від’ємних елементів
        printf("Добуток елементів між min і max: %lld\n", productBetween);// Виведення добутку елементів між мінімальним і максимальним 
    }

    return 0;
}
